<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Team 7712 ACCN-Umoja Scouting</title>
        <link rel="manifest" href="/manifest.json">
        <meta name="theme-color" content="#1a472a">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <link rel="icon" href="./team7712_logo.svg">
        <link rel="icon" type="image/png" sizes="32x32" href="./team7712_logo_reefscape.png">
        <link rel="icon" type="image/png" sizes="192x192" href="./team7712_logo_reefscape.png">
        <link rel="apple-touch-icon" sizes="180x180" href="./team7712_logo_reefscape.png">
        <link rel="apple-touch-icon" sizes="152x152" href="./team7712_logo_reefscape.png">
        <link rel="stylesheet" href="/styles.css?v=20251216">
        <!-- Prefer CDN for QR generation for now (falls back to local vendor if available) -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
        <script>
            // If CDN fails to load, the local vendor file will be used as fallback
            window.addEventListener('error', (e) => {
                if (e.target && e.target.src && e.target.src.includes('qrcode.min.js')) {
                    console.warn('CDN qrcode failed to load, falling back to local vendor');
                    var s = document.createElement('script'); s.src = '/vendor/qrcode.min.js'; document.head.appendChild(s);
                }
            }, true);
        </script>
        <script>
            // prevent flash of wrong page on initial load
            document.addEventListener('DOMContentLoaded', () => document.body.classList.add('home-active'));
        </script>
        </head>
<body class="home-active">
    <div class="container">
        <div class="header">
            <img id="teamLogo" src="./team7712_logo_reefscape.png?v=20251205" alt="Team 7712 Logo" class="logo">
            <h1>Team 7712 ACCN-Umoja</h1>
            <div class="subtitle">FRC 2026 Scouting - REBUILT</div>
            <div style="margin-top:6px; font-size:12px; color:#ccc;">Build v2.3.0</div>
        </div>

        <!-- Home Page -->
        <div id="homePage" class="page active">
            <div class="menu-container">
                <div class="menu-grid">
                    <button class="menu-btn" onclick="navigateToPage('scoutPage')"><div class="menu-btn-text">Scout Match</div></button>
                    <button class="menu-btn" onclick="navigateToPage('pitScoutPage')"><div class="menu-btn-text">Pit Scout</div></button>
                    <button class="menu-btn" onclick="navigateToPage('dataPage')"><div class="menu-btn-text">View Data</div></button>
                    <button class="menu-btn" onclick="openTransferModal()"><div class="menu-btn-text">Transfer Data</div></button>
                    <button class="menu-btn" onclick="navigateToPage('collectorPage')"><div class="menu-btn-text">Collect (QR)</div></button>
                </div>
                <button class="menu-btn full-width" onclick="showInstall()"><div class="menu-btn-text">Install App</div></button>
            </div>
        </div>

        <!-- Scout Page -->
        <div id="scoutPage" class="page">
            <button class="back-btn" onclick="navigateBack()">Back</button>
            <h2>Scout Match</h2>
            <form id="matchForm" onsubmit="submitMatch(event)">
                <div class="form-group">
                    <label for="location">Location</label>
                    <select id="location" name="location">
                        <option value="ONT District Durham College Event">ONT District Durham College Event</option>
                        <option value="ONT District North Bay Event">ONT District North Bay Event</option>
                        <option value="FIRST Ontario Provincial Championship">FIRST Ontario Provincial Championship</option>
                        <option value="FIRST Championship">FIRST Championship</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="matchNumber">Match Number</label>
                    <input type="number" id="matchNumber" name="matchNumber" required min="1">
                </div>
                <div class="form-group">
                    <label for="teamNumber">Team Number</label>
                    <input type="number" id="teamNumber" name="teamNumber" required min="1">
                </div>
                <div class="form-group">
                    <label for="alliance">Alliance</label>
                    <select id="alliance" name="alliance" required>
                        <option value="red">Red</option>
                        <option value="blue">Blue</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="scoutName">Scout Name</label>
                    <input type="text" id="scoutName" name="scoutName" required>
                </div>

                <h3>Autonomous</h3>
                <div class="form-group">
                    <label for="startPosition">Starting Position</label>
                    <select id="startPosition" name="startPosition">
                        <option value="Not recorded" selected>Not recorded</option>
                        <option value="Left">Left (near alliance wall left)</option>
                        <option value="Center">Center</option>
                        <option value="Right">Right (near alliance wall right)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>FUEL Scoring (Auto)</label>
                    <select id="autoFuelCategory" name="autoFuelCategory">
                        <option value="Not observed" selected>Not observed yet</option>
                        <option value="High">High - 5+ FUEL scored consistently</option>
                        <option value="Medium">Medium - 2-4 FUEL scored</option>
                        <option value="Low">Low - 1 FUEL or inconsistent attempts</option>
                        <option value="None">None - Does not score FUEL</option>
                    </select>
                    <small style="color: #888;">High=5+ | Medium=2-4 | Low=1 or attempts | None=no FUEL</small>
                </div>
                <div class="form-group">
                    <label for="autoTower">TOWER Climb (Auto)</label>
                    <select id="autoTower" name="autoTower">
                        <option value="None" selected>No Climb</option>
                        <option value="Level 1">Level 1 (15 pts)</option>
                    </select>
                </div>

                <h3>Teleop</h3>
                <div class="form-group">
                    <label>FUEL Scoring (Teleop)</label>
                    <select id="teleopFuelCategory" name="teleopFuelCategory">
                        <option value="Not observed" selected>Not observed yet</option>
                        <option value="High">High - 10+ FUEL scored consistently</option>
                        <option value="Medium">Medium - 4-9 FUEL scored</option>
                        <option value="Low">Low - 1-3 FUEL or inconsistent</option>
                        <option value="None">None - Does not score FUEL</option>
                    </select>
                    <small style="color: #888;">High=10+ | Medium=4-9 | Low=1-3 or attempts | None=no FUEL</small>
                </div>
                <div class="form-group">
                    <label for="navigation">Field Navigation</label>
                    <select id="navigation" name="navigation">
                        <option value="Not observed" selected>Not observed yet</option>
                        <option value="Goes over BUMPS">Goes over BUMPS</option>
                        <option value="Goes through TRENCHES">Goes through TRENCHES</option>
                        <option value="Both BUMPS and TRENCHES">Both (versatile drivetrain)</option>
                        <option value="Avoids/struggles">Avoids obstacles / struggles</option>
                    </select>
                    <small style="color: #666;">Track drivetrain capabilities for strategy planning</small>
                </div>

                <h3>Defense</h3>
                <div class="form-group">
                    <label for="playedDefense">Played Defense?</label>
                    <select id="playedDefense" name="playedDefense">
                        <option value="No" selected>No</option>
                        <option value="Yes">Yes</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="defenseEffectiveness">Defense Effectiveness (if played)</label>
                    <select id="defenseEffectiveness" name="defenseEffectiveness">
                        <option value="Not applicable" selected>Not applicable / Did not play defense</option>
                        <option value="High">High - Significantly slowed opponents</option>
                        <option value="Medium">Medium - Some impact on opponents</option>
                        <option value="Low">Low - Minimal impact</option>
                    </select>
                </div>
                <!-- debug button removed -->

                <h3>Endgame</h3>
                <div class="form-group">
                    <label for="teleopTower">TOWER Climb (Teleop/Endgame)</label>
                    <select id="teleopTower" name="teleopTower">
                        <option value="None" selected>No Climb</option>
                        <option value="Level 1">Level 1 - Off ground (10 pts)</option>
                        <option value="Level 2">Level 2 - BUMPERS above LOW RUNG (20 pts)</option>
                        <option value="Level 3">Level 3 - BUMPERS above MID RUNG (30 pts)</option>
                    </select>
                    <small style="color: #666;">Level 1: Robot off ground | Level 2: BUMPERS above 27" | Level 3: BUMPERS above 45"</small>
                </div>

                <h3>Match Performance</h3>
                <div class="form-group">
                    <label for="foulsObserved">Fouls/Penalties Observed</label>
                    <select id="foulsObserved" name="foulsObserved">
                        <option value="None" selected>None observed</option>
                        <option value="Minor">Minor (1-2 fouls)</option>
                        <option value="Major">Major (3+ fouls or tech foul)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="robotStatus">Robot Status During Match</label>
                    <select id="robotStatus" name="robotStatus">
                        <option value="Worked full match" selected>Worked full match</option>
                        <option value="Partial breakdown">Partial breakdown (recovered)</option>
                        <option value="Disabled">Disabled (did not recover)</option>
                        <option value="No show">No show / Did not move</option>
                    </select>
                </div>
                <div class="form-group">
                    <button type="button" class="btn" style="background: #dc3545; width: 100%; font-size: 18px; padding: 14px;" onclick="markRobotMalfunction()">‚ö†Ô∏è Robot Malfunction (Entire Match)</button>
                    <small style="color: #888;">Tap this if robot was broken/disabled for the entire match ‚Äî auto-fills status fields</small>
                </div>
                <div class="form-group">
                    <label for="consistencyRating">Overall Consistency/Reliability</label>
                    <select id="consistencyRating" name="consistencyRating">
                        <option value="Reliable" selected>Reliable - Performed as expected</option>
                        <option value="Average">Average - Some variability</option>
                        <option value="Unreliable">Unreliable - Inconsistent performance</option>
                    </select>
                    <small style="color: #666;">Compare this match to their typical performance</small>
                </div>

                <h3>Human Player</h3>
                <div class="form-group">
                    <label for="humanPlayerTeam">Human Player Team #</label>
                    <input type="number" id="humanPlayerTeam" name="humanPlayerTeam" min="1" max="99999" placeholder="Team number of human player">
                    <small style="color: #666;">Enter the team number of your alliance's human player</small>
                </div>
                <div class="form-group">
                    <label for="humanPlayerRating">Human Player Performance</label>
                    <select id="humanPlayerRating" name="humanPlayerRating">
                        <option value="Not observed" selected>Not observed</option>
                        <option value="Good">Good - Accurate & fast FUEL feeds</option>
                        <option value="Average">Average - Some missed feeds</option>
                        <option value="Poor">Poor - Slow or inaccurate feeds</option>
                    </select>
                    <small style="color: #666;">Rate accuracy and speed of FUEL feeding to robots</small>
                </div>

                <div class="form-group">
                    <label for="notes">Notes</label>
                    <textarea id="notes" name="notes" rows="4" placeholder="Observations, issues, strengths..."></textarea>
                </div>
                <button type="submit" class="btn success">Save Match</button>
            </form>
        </div>

        <!-- Pit Scout Page -->
        <div id="pitScoutPage" class="page">
            <button class="back-btn" onclick="navigateBack()">Back</button>
            <h2>Pit Scouting</h2>
            <form id="pitScoutForm" onsubmit="submitPitScout(event)">
                <div class="form-group">
                    <label for="pitTeamNumber">Team Number</label>
                    <input type="number" id="pitTeamNumber" name="pitTeamNumber" required>
                </div>
                <div class="form-group">
                    <label for="pitScoutName">Scout Name</label>
                    <input type="text" id="pitScoutName" name="pitScoutName" required>
                </div>
                
                <h3>Robot Information</h3>
                <div class="form-group">
                    <label>Robot Photo</label>
                    <div style="text-align: center; margin-bottom: 12px;">
                        <img id="robotPhotoPreview" style="display:none; max-width:100%; max-height:250px; border:3px solid #DAA520; border-radius:12px; margin-bottom:8px;" alt="Robot photo">
                        <br>
                        <button type="button" class="btn" style="font-size:16px; padding:12px 24px;" onclick="captureRobotPhoto()">üì∑ Take Photo</button>
                        <button type="button" class="btn" style="font-size:16px; padding:12px 24px;" onclick="pickRobotPhoto()">üñºÔ∏è Choose Photo</button>
                        <input type="file" id="robotPhotoInput" accept="image/*" style="display:none" onchange="handleRobotPhoto(event)">
                        <input type="file" id="robotCameraInput" accept="image/*" capture="environment" style="display:none" onchange="handleRobotPhoto(event)">
                    </div>
                </div>
                <div class="form-group">
                    <label for="robotDimension">Robot Dimensions (L x W x H)</label>
                    <input type="text" id="robotDimension" name="robotDimension" placeholder="e.g., 28 x 26 x 42 inches">
                </div>
                <div class="form-group">
                    <label for="robotWeight">Robot Weight (lbs)</label>
                    <input type="number" id="robotWeight" name="robotWeight" placeholder="e.g., 120">
                </div>
                <div class="form-group">
                    <label for="drivetrainType">Drivetrain Type</label>
                    <select id="drivetrainType" name="drivetrainType">
                        <option value="Not specified">Not specified</option>
                        <option value="Tank/West Coast">Tank/West Coast</option>
                        <option value="Swerve">Swerve</option>
                        <option value="Mecanum">Mecanum</option>
                        <option value="H-Drive">H-Drive</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="navigationCapability">Navigation Capability</label>
                    <select id="navigationCapability" name="navigationCapability">
                        <option value="Not specified">Not specified</option>
                        <option value="Goes over BUMPS">Goes over BUMPS</option>
                        <option value="Goes through TRENCHES">Goes through TRENCHES</option>
                        <option value="Both BUMPS and TRENCHES">Both BUMPS and TRENCHES</option>
                    </select>
                </div>

                <h3>Game Performance</h3>
                <div class="form-group">
                    <label for="autoScore">Auto Score Capability</label>
                    <textarea id="autoScore" name="autoScore" rows="3" placeholder="What can they do in auto? (e.g., score 3 FUEL, climb Level 1, leave starting zone)"></textarea>
                </div>
                <div class="form-group">
                    <label for="fuelCapacity">Robot FUEL Capacity</label>
                    <input type="number" id="fuelCapacity" name="fuelCapacity" placeholder="How many FUEL can they hold?">
                </div>
                <div class="form-group">
                    <label for="climbCapability">TOWER Climb Capability</label>
                    <select id="climbCapability" name="climbCapability">
                        <option value="Not specified">Not specified</option>
                        <option value="None">Cannot climb</option>
                        <option value="Level 1">Level 1 (off ground)</option>
                        <option value="Level 2">Level 2 (BUMPERS above LOW RUNG)</option>
                        <option value="Level 3">Level 3 (BUMPERS above MID RUNG)</option>
                    </select>
                </div>

                <h3>Team Information</h3>
                <div class="form-group">
                    <label for="driverExperience">Driver Experience</label>
                    <select id="driverExperience" name="driverExperience">
                        <option value="Not specified">Not specified</option>
                        <option value="New driver">New driver (rookie)</option>
                        <option value="1 year">1 year experience</option>
                        <option value="2 years">2 years experience</option>
                        <option value="3+ years">3+ years experience</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="pitNotes">Additional Notes</label>
                    <textarea id="pitNotes" name="pitNotes" rows="4" placeholder="Design features, strengths, weaknesses, special capabilities..."></textarea>
                </div>
                <button type="submit" class="btn success">Save Pit Scout</button>
            </form>
        </div>

        <!-- Data Page -->
        <div id="dataPage" class="page">
            <button class="back-btn" onclick="navigateBack()">Back</button>
            <h2>Scouting Data</h2>
            <div id="dataDisplay"></div>
            <div style="margin-top: 20px;">
                <button class="btn" onclick="openTransferModal()">Transfer</button>
                <button class="btn danger" onclick="openClearDataModal()">Clear</button>
            </div>
        </div>

        <!-- Collector Page -->
        <div id="collectorPage" class="page">
            <button class="back-btn" onclick="navigateBack()">Back</button>
            <h2>Collect Data (QR)</h2>
            <p style="margin: 15px 0; color: #ccc; font-size: 16px;">
                Import data from another device using QR codes:<br>
                <strong>Works 100% offline ‚Äî no internet needed.</strong>
            </p>
            <div style="margin: 20px 0; text-align: center;">
                <button class="btn success" style="font-size: 18px; padding: 20px 40px; width: 100%; margin-bottom: 12px;" onclick="startLiveCameraScan()">üì∑ Scan with Camera</button>
                <button class="btn" style="font-size: 16px; padding: 14px 30px; width: 100%;" onclick="openImageQR()">üñºÔ∏è Scan QR From Image</button>
            </div>
            <div id="liveScanContainer" style="display:none; margin: 16px 0; text-align:center;">
                <video id="scanVideo" autoplay playsinline style="width:100%; max-width:400px; border:3px solid #DAA520; border-radius:12px;"></video>
                <p id="scanStatus" style="color:#DAA520; margin-top:8px;">Point camera at QR code...</p>
                <button class="btn danger" style="margin-top:8px;" onclick="stopLiveCameraScan()">Stop Camera</button>
            </div>
            <canvas id="qrCanvas" style="display:none"></canvas>
        </div>
    </div>

    <script src="/app.js"></script>
</body>
</html>



